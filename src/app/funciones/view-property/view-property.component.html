<div class="container my-5">
    <div *ngIf="inmueble !== undefined" class="propiedades-detalles">
        <div class="row">
            <div class="col-md-6">
                <img [src]="inmueble.foto" class="img-fluid rounded w-100" alt="Imagen del inmueble">
            </div>
            <div class="col-md-6">
                <h1>{{inmueble.titulo}}</h1>
                <p class="text-muted">{{inmueble.precio}}€ / noche - {{inmueble.metrosCuadrados}}m<sup>2</sup></p>
                <p>{{inmueble.comunidadAutonoma}} - {{inmueble.provincia}} - {{inmueble.municipio}} - {{inmueble.calle}}</p>
                <h4>Descripción</h4>
                <p>{{inmueble.descripcion}}</p>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-6">
                <h4>Detalles del inmueble</h4>
                <ul class="list-group">
                    <li class="list-group-item">Nº Habitaciones: {{inmueble.numHabitaciones}}</li>
                    <li class="list-group-item">Nº Baños: {{inmueble.numBanios}}</li>
                    <li class="list-group-item">Nº pisos: {{inmueble.numPisos}}</li>
                    <li class="list-group-item">Terrazas: {{inmueble.numTerrazas}}</li>
                    <li class="list-group-item">Garaje: {{inmueble.garaje ? 'Disponible' : 'No disponible'}}</li>
                    <li class="list-group-item"><strong>Contacto propietario:</strong> {{inmueble.correoPropietario}}</li>
                </ul>
            </div>
            <div class="col-md-6">
                <div>
                    <label for="fechaInicio">Fecha de Entrada</label>
                    <input type="date" class="form-control" name="fechaInicio" [(ngModel)]="fechaInicio">
                    <label for="fechaFin" class="mt-3">Fecha de Salida</label>
                    <input type="date" class="form-control" name="fechaFin" [(ngModel)]="fechaFin">
                    <button class="btn btn-primary mt-3" (click)="solicitarReserva()">Solicitar Reserva</button>
                    <button class="btn btn-primary mt-3" style="margin-left: 5px;" (click)="mostrarOcultarReservas()">{{ mostrarOcultar }}</button>
                </div>
                <div *ngIf="mostrarOcultar === 'Ocultar reservas'" class="mt-3">
                    <h3>Rangos de Reservas</h3>
                    <ul class="list-group">
                        <li class="list-group-item" *ngFor="let reserva of inmueble.reservas">
                            {{ reserva.fechaInicio | date: 'dd/MM/yyyy' }} - {{ reserva.fechaFin | date: 'dd/MM/yyyy' }}
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-6">
                <h3>Comentarios</h3>
                <div *ngFor="let c of comentarios" class="mb-2">
                    <p><strong>{{c[0]}}:</strong> {{c[1]}}</p>
                </div>
                <div class="mt-3">
                    <label for="comentario">Escribe tu comentario:</label>
                    <textarea class="form-control" name="comentario" [(ngModel)]="comentario" required></textarea>
                    <button (click)="agregarComentario()" class="btn btn-primary mt-2">Agregar Comentario</button>
                </div>
            </div>
            <div class="col-md-6">
                <h3>Dar puntuación:</h3>
                <p>Puntuación Media: {{ valoracionMedia }} estrellas</p>
                <div>
                    <span class="estrella" (click)="puntuar(1)">&#9733;</span>
                    <span class="estrella" (click)="puntuar(2)">&#9733;</span>
                    <span class="estrella" (click)="puntuar(3)">&#9733;</span>
                    <span class="estrella" (click)="puntuar(4)">&#9733;</span>
                    <span class="estrella" (click)="puntuar(5)">&#9733;</span>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-md-12">
                <div *ngIf="usuarioLogeado !== undefined && usuarioLogeado.uid === inmueble.propietario">
                    <button class="btn btn-primary" (click)="modificarInmueble()">Editar</button>
                    <button class="btn btn-danger ms-2" (click)="eliminarPropiedad()">Eliminar</button>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="inmueble === undefined" class="text-center mt-5">
        <h1 class="text-danger">Propiedad no encontrada</h1>
        <button routerLink="/home" class="btn btn-primary mt-3">Volver a Inicio</button>
    </div>
</div>
